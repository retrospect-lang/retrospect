if prep {
  m = matrix([4, 4], [
    1, 0, 1, 1,
    1, 0, 1, 0,
    1, 1, 1, 1,
    1, 1, 0, 1
  ])
  _ = bfs(m, [1, 4], [4, 1])
  _ = bfs(m, [1, 1], [4, 4])
  m = matrix([5, 5], [
    1, 0, 1, 1, 1,
    1, 1, 1, 0, 1,
    1, 1, 1, 1, 1,
    0, 1, 0, 0, 1,
    1, 1, 1, 1, 1
  ])
  return bfs(m, [5, 1], [1, 5])
}
m1 = matrix([10, 10], [
  1, 0, 1, 1, 1, 0, 1, 0, 1, 0,
  1, 0, 1, 0, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 0, 1, 0, 0, 1, 0, 1,
  0, 1, 0, 0, 1, 0, 1, 1, 0, 1,
  1, 1, 1, 0, 1, 0, 0, 1, 0, 1,
  0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 0, 0, 0, 0, 1, 0, 1,
  1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 0, 0, 1, 0, 0, 0, 0, 0, 0,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1
])

m2 = matrix([10, 10], [
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1
])
start = [1, 1]
end = [10, 10]
return [bfs(m1, start, end), bfs(m2, start, end)]

function bfs (m, start, end) {
  [h, w] = sizes(m)
  frontier = [start]  // the set of points on the exploration frontier
  visited = newMatrix([h, w], None)  // each cell will point to its predecessor
  visited @ start = start
  ds = [[-1, 0], [1, 0], [0, -1], [0, 1]]  // Delta vectors to neighbors.

  for sequential frontier, visited {
    if size(frontier) == 0 { break { return [] }}
    // for each endpoint e in frontier
    for e in frontier {
      // are we done?
      if e[1] == end[1] and e[2] == end[2] {
        path = [e]
        for sequential path, e {
          e = visited @ e
          path[1..0] = [e]
          if e[1] == start[1] and e[2] == start[2] {
            break { break { break { return path }}}
          }
        }
      }
      // Emit each valid, unvisited, traversible neighbor of e
      nextHops <<^
          ds | d -> (e + d | save)
             | filter(n -> (n[1] > 0 and n[1] <= h and n[2] > 0 and n[2] <= w
                            and (visited @ n) is None and (m @ n) == 1))
             | n -> [e, n]
    } collect {
      nextHops =| saveUnordered
    }
    frontier = []
    for [from, to] in nextHops sequential visited, frontier {
      if (visited @ to) is None {
        visited @ to = from
        frontier &= [to]
      }
    }
  }
}

/* CODEGEN bfs RETURNS
  [[[1, 1], [2, 1], [3, 1], [3, 2], [3, 3], [2, 3], [1, 3], [1, 4], [1, 5],
    [2, 5], [3, 5], [4, 5], [5, 5], [6, 5], [6, 6], [6, 7], [6, 8], [7, 8],
    [8, 8], [8, 7], [8, 6], [8, 5], [8, 4], [9, 4], [10, 4], [10, 5], [10, 6],
    [10, 7], [10, 8], [10, 9], [10, 10]], [[1, 1], [2, 1], [3, 1], [4, 1],
    [5, 1], [6, 1], [7, 1], [8, 1], [9, 1], [10, 1], [10, 2], [10, 3], [10, 4],
    [10, 5], [10, 6], [10, 7], [10, 8], [10, 9], [10, 10]]]
---
bfs_0(ReshapedArray([i1, i2], x3:*[]@xxxx), [i4, i5], [i6, i7]):
   1: AtomicInteger.incrementAndGet(0);
   2: test I1 < 0; T:→ 233
   3: test I2 < 0; T:→ 233
   4: I8 ← Math.multiplyExact(I1, I2); ArithmeticException:→ 233
   5: test TState.reserveForChange(X0, *[]b0⸨0:[b1, b2]; 1:None⸩@xxxx, null, I8) == 0; T:→ 233
   6: X9 ← alloc*[]b0⸨0:[b1, b2]; 1:None⸩@xxxx(X0, I8);
   7: ArrayUtil.bytesFillB(Frame1i4x.x0(X9), 0, I8, 1);
   8: test 0 < I4; F:→ 232
   9: test I1 < I4; T:→ 232
  10: test 0 < I5; F:→ 232
  11: test I2 < I5; T:→ 232
  12: I8 ← Math.addExact(Math.multiplyExact(iSub(I4, 1), I2), iSub(I5, 1)); ArithmeticException:→ 232
  13: test I8 < 0; T:→ 232
  14: test I8 < Frame1i4x.i0(X9); F:→ 232
  15: setUint8[](Frame1i4x.x0(X9), I8, 0);
  16: test I4 isUint8; F:→ 232
  17: setUint8[](Frame1i4x.x1(X9), I8, I4);
  18: test I5 isUint8; F:→ 232
  19: setUint8[](Frame1i4x.x2(X9), I8, I5);
  20: X8 ← alloc*[][b0, b1]@xxxx(X0, 1);
  21: setUint8[](Frame1i2x.x0(X8), 0, I4);
  22: setUint8[](Frame1i2x.x1(X8), 0, I5);
= 23: test Frame1i2x.i0(X8) == 0; T:→ 62
  24: I11 ← 0;
  25: X12 ← [];
= 26: test I11 < Frame1i2x.i0(X8); F:→ 85
  27: I10 ← uint8[](Frame1i2x.x0(X8), I11);
  28: I13 ← uint8[](Frame1i2x.x1(X8), I11);
  29: I11 ← iAdd(I11, 1);
  30: test I10 == I6; F:→ 32
  31: test I13 == I7; T:→ 122
- 32: I14 ← 0;
= 33: I15 ← iAdd(I14, 1);
  34: test I14 == 0; F:→ 67
  35: I14 ← -1;
  36: I16 ← 0;
= 37: I18 ← Math.addExact(I10, I14); ArithmeticException:→ 213
  38: I19 ← Math.addExact(I13, I16); ArithmeticException:→ 206
  39: test 0 < I18; F:→ 59
  40: test I1 < I18; T:→ 59
  41: test 0 < I19; F:→ 59
  42: test I2 < I19; T:→ 59
  43: test X9 is *[]b0⸨0:[b1, b2]; 1:None⸩@xxxx; F:→ 188
  44: test I1 < I18; T:→ 188
  45: test I2 < I19; T:→ 188
  46: I17 ← Math.addExact(Math.multiplyExact(iSub(I18, 1), I2), iSub(I19, 1)); ArithmeticException:→ 188
  47: I17 ← iAdd(I17, 1);
  48: test I17 < 1; T:→ 188
  49: test Frame1i4x.i0(X9) < I17; T:→ 188
  50: test uint8[](Frame1i4x.x0(X9), iSub(I17, 1)) 1 (< 2); F:→ 59
  51: test X3 is *[]b0@xxxx; F:→ 188
  52: test I1 < I18; T:→ 188
  53: test I2 < I19; T:→ 188
  54: I17 ← Math.addExact(Math.multiplyExact(iSub(I18, 1), I2), iSub(I19, 1)); ArithmeticException:→ 188
  55: I17 ← iAdd(I17, 1);
  56: test I17 < 1; T:→ 188
  57: test Frame1i2x.i0(X3) < I17; T:→ 188
  58: test uint8[](Frame1i2x.x0(X3), iSub(I17, 1)) == 1; T:→ 75
- 59: I14 ← I15;
= 60: test I14 < 4; T:→ 33, F:→ 26
= 61: test X8 is *[][b0, b1]@xxxx; T:→ 23
- 62: X10 ← newStackEntry(⟦LoopCore.IterateUnbounded.afterAt ∥ state=loop@55_state⸨frontier=X8, visited=ReshapedArray([I1, I2], X9)⸩, lambda=loop@55⸨end=[I6, I7], start=[I4, I5], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=I1, w=I2, m=ReshapedArray([I1, I2], X3)⸩⟧);
  63: X1 ← TState.fillStackEntry(X0, null, X10, ⟨LoopExit(loop@55_break@66⸨path=x0:*[]@xxxx⸩)⟩, mMemo_h38@xxxx, null);
= 64: X1 ← TState.fillStackEntry(X0, X1, ⟦bfs.r8t+0:55_6 _t0 = iterateUnbounded(loop@55⸨end=end, start=start, ds=ds, h=h, w=w, m=m⸩, loop@55_state⸨frontier=frontier, visited=visited⸩)⟧, ⟨x0:*[]@xxxx⟩, mMemo_x@xxxx, null);
= 65: TState.setStackRest(X0, X1);
  66: return
- 67: test I14 == 1; F:→ 70
  68: I14 ← 1;
  69: I16 ← 0; → 37
- 70: test I14 == 2; F:→ 73
  71: I14 ← 0;
  72: I16 ← -1; → 37
- 73: I14 ← 0;
  74: I16 ← 1; → 37
- 75: I14 ← Frame1i4x.i0(X12);
  76: test TState.reserveForChange(X0, *[][[b0, b1], [b2, b3]]@xxxx, X12, iAdd(I14, 1)) == 0; T:→ 186
  77: X12 ← removeRange*[][[b0, b1], [b2, b3]]@xxxx(X0, X12, I14, 0, 1);
  78: setUint8[](Frame1i4x.x0(X12), I14, I10);
  79: setUint8[](Frame1i4x.x1(X12), I14, I13);
  80: test I18 isUint8; F:→ 174
  81: setUint8[](Frame1i4x.x2(X12), I14, I18);
  82: test I19 isUint8; F:→ 174
  83: setUint8[](Frame1i4x.x3(X12), I14, I19);
  84: I14 ← I15; → 60
- 85: dropRef{X8};
  86: I10 ← 0;
  87: X8 ← [];
= 88: test X12 is *[][[b0, b1], [b2, b3]]@xxxx; F:→ 170
  89: test I10 < Frame1i4x.i0(X12); F:→ 121
  90: test X9 is *[]b0⸨0:[b1, b2]; 1:None⸩@xxxx; F:→ 170
  91: I15 ← uint8[](Frame1i4x.x2(X12), I10);
  92: test 0 < I15; F:→ 170
  93: test I1 < I15; T:→ 170
  94: I16 ← uint8[](Frame1i4x.x3(X12), I10);
  95: test 0 < I16; F:→ 170
  96: test I2 < I16; T:→ 170
  97: I11 ← iAdd(I10, 1);
  98: I13 ← uint8[](Frame1i4x.x0(X12), I10);
  99: I14 ← uint8[](Frame1i4x.x1(X12), I10);
 100: I17 ← Math.addExact(Math.multiplyExact(iSub(I15, 1), I2), iSub(I16, 1)); ArithmeticException:→ 170
 101: I17 ← iAdd(I17, 1);
 102: test I17 < 1; T:→ 170
 103: test Frame1i4x.i0(X9) < I17; T:→ 170
 104: test uint8[](Frame1i4x.x0(X9), iSub(I17, 1)) 1 (< 2); F:→ 120
 105: test I1 < I15; T:→ 170
 106: test I2 < I16; T:→ 170
 107: I17 ← Math.addExact(Math.multiplyExact(iSub(I15, 1), I2), iSub(I16, 1)); ArithmeticException:→ 170
 108: test I17 < 0; T:→ 170
 109: test I17 < Frame1i4x.i0(X9); F:→ 170
 110: X9 ← FrameLayout.ensureUnshared(*[]b0⸨0:[b1, b2]; 1:None⸩@xxxx, X0, X9);
 111: setUint8[](Frame1i4x.x0(X9), I17, 0);
 112: setUint8[](Frame1i4x.x1(X9), I17, I13);
 113: setUint8[](Frame1i4x.x2(X9), I17, I14);
 114: I13 ← Frame1i2x.i0(X8);
 115: test TState.reserveForChange(X0, *[][b0, b1]@xxxx, X8, iAdd(I13, 1)) == 0; T:→ 168
 116: X8 ← removeRange*[][b0, b1]@xxxx(X0, X8, I13, 0, 1);
 117: test I13 < Frame1i2x.i0(X8); F:→ 155
 118: setUint8[](Frame1i2x.x0(X8), I13, I15);
 119: setUint8[](Frame1i2x.x1(X8), I13, I16);
-120: I10 ← I11; → 88
-121: dropRef{X12}; → 61
-122: dropRef{X12};
 123: X12 ← alloc*[][b0, b1]@xxxx(X0, 1);
 124: setUint8[](Frame1i2x.x0(X12), 0, I10);
 125: setUint8[](Frame1i2x.x1(X12), 0, I13);
=126: test X9 is *[]b0⸨0:[b1, b2]; 1:None⸩@xxxx; F:→ 230
 127: test 0 < I10; F:→ 230
 128: test I1 < I10; T:→ 230
 129: test 0 < I13; F:→ 230
 130: test I2 < I13; T:→ 230
 131: I14 ← Math.addExact(Math.multiplyExact(iSub(I10, 1), I2), iSub(I13, 1)); ArithmeticException:→ 230
 132: I14 ← iAdd(I14, 1);
 133: test I14 < 1; T:→ 230
 134: test Frame1i4x.i0(X9) < I14; T:→ 230
 135: I16 ← iSub(I14, 1);
 136: I14 ← uint8[](Frame1i4x.x0(X9), I16);
 137: test uint8[](Frame1i4x.x0(X9), I16) == 0; T:→ 149
 138: I15 ← 0;
 139: I16 ← 0;
=140: test I14 == 0; F:→ 230
 141: X12 ← removeRange*[][b0, b1]@xxxx(X0, X12, 0, 0, 1);
 142: test 0 < Frame1i2x.i0(X12); F:→ 219
 143: setUint8[](Frame1i2x.x0(X12), 0, I15);
 144: setUint8[](Frame1i2x.x1(X12), 0, I16);
 145: test I15 == I4; F:→ 147
 146: test I16 == I5; T:→ 151
-147: I10 ← I15;
 148: I13 ← I16; → 126
-149: I15 ← uint8[](Frame1i4x.x1(X9), I16);
 150: I16 ← uint8[](Frame1i4x.x2(X9), I16); → 140
-151: dropRef{X3, X9, X8};
 152: TState.setResultTemplates(X0, [x0:*[]@xxxx]);
 153: setObject[](TState.fnResults(X0, 1), 0, X12);
 154: return
-155: X10 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=0, it=ArrayIterator([[I15, I16]], EnumerateAllKeys, 0)⟧);
 156: X10 ← TState.fillStackEntry(X0, null, X10, ⟨⸨[[1], [b0, b0]]; Absent⸩, ArrayIterator([[b0, b0]], EnumerateAllKeys, 1), SaverLoop(SaveWithOffset(b0)), x0:*[]@xxxx⟩, mMemo_1@xxxx, null);
 157: X14 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=SaverLoop(SaveWithOffset(I13)), state=X8⟧);
 158: X10 ← TState.fillStackEntry(X0, X10, X14, ⟨x0:*[]@xxxx⟩, mMemo_5@xxxx, null);
 159: X10 ← TState.fillStackEntry(X0, X10, ⟦LoopCore.enumerateDefault⟧, ⟨x0:*[]@xxxx⟩, mMemo_6@xxxx, null);
 160: X10 ← TState.fillStackEntry(X0, X10, ⟦MatrixCore.ConcatUpdate.afterSizes⟧, ⟨x0:*[]@xxxx⟩, mMemo_8@xxxx, null);
 161: X8 ← newStackEntry(⟦bfs.r8t+0:83_5 frontier = concatUpdate(frontier, [to]) ∥ visited=ReshapedArray([I1, I2], X9)⟧);
 162: X10 ← TState.fillStackEntry(X0, X10, X8, ⟨loop@80_state⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), frontier=x0:*[]@xxxx⸩, loop@80, ArrayIterator(x0:*[]@xxxx, EnumerateValues, b0)⟩, mMemo_16@xxxx, null);
=163: X8 ← newStackEntry(⟦LoopCore.Iterate.nextState ∥ loop=loop@80, it=ArrayIterator(X12, EnumerateValues, I11)⟧);
 164: X8 ← TState.fillStackEntry(X0, X10, X8, ⟨loop@80_state⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), frontier=x0:*[]@xxxx⸩⟩, mMemo_19@xxxx, null);
=165: X8 ← TState.fillStackEntry(X0, X8, ⟦bfs.r8t+0:80_20 _t0 = iterate(nextHops, EnumerateValues, loop@80, loop@80_state⸨visited=visited, frontier=frontier⸩)⟧, ⟨⸨LoopExit(loop@55_break@66⸨path=x0:*[]@xxxx⸩); loop@55_state⸨frontier=x0:*[]@xxxx, visited=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩⸩, loop@55⸨end=[b0, b0], start=[b0, b0], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=b0, w=b0, m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩⟩, mMemo_h72@xxxx, null);
=166: X9 ← newStackEntry(⟦LoopCore.IterateUnbounded.at ∥ lambda=loop@55⸨end=[I6, I7], start=[I4, I5], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=I1, w=I2, m=ReshapedArray([I1, I2], X3)⸩⟧);
 167: X1 ← TState.fillStackEntry(X0, X8, X9, ⟨LoopExit(loop@55_break@66⸨path=x0:*[]@xxxx⸩)⟩, mMemo_h38@xxxx, null); → 64
-168: X10 ← newStackEntry(⟦bfs.r8t+0:83_5 frontier = concatUpdate(frontier, [to]) ∥ visited=ReshapedArray([I1, I2], X9), frontier=X8, to=[I15, I16]⟧);
 169: X10 ← TState.fillStackEntry(X0, null, X10, ⟨loop@80_state⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), frontier=x0:*[]@xxxx⸩, loop@80, ArrayIterator(x0:*[]@xxxx, EnumerateValues, b0)⟩, mMemo_16@xxxx, null); → 163
-170: X11 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=I10, it=ArrayIterator(X12, EnumerateValues, I10)⟧);
 171: X10 ← TState.fillStackEntry(X0, null, X11, ⟨⸨[[b0, b0], [b0, b0]]; Absent⸩, ArrayIterator(x0:*[]@xxxx, EnumerateValues, b0), loop@80, loop@80_state⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), frontier=x0:*[]@xxxx⸩⟩, mMemo_1@xxxx, null);
 172: X11 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=loop@80, state=loop@80_state⸨visited=ReshapedArray([I1, I2], X9), frontier=X8⸩⟧);
 173: X8 ← TState.fillStackEntry(X0, X10, X11, ⟨loop@80_state⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), frontier=x0:*[]@xxxx⸩⟩, mMemo_19@xxxx, null); → 165
-174: X16 ← newStackEntry(⟦ReducerCore.NextStateSaveUnordered.replace ∥ state=X12, index=I14, value=[[I10, I13], [I18, I19]]⟧);
 175: X14 ← TState.fillStackEntry(X0, null, X16, ⟨x0:*[]@xxxx, SaveUnordered, TransformedIterator(ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, b0), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[b0, b0]⸩, Filter(lambda@73:24⸨h=b0, w=b0, visited=ReshapedArray([b0, b0], x0:*[]@xxxx), m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩)), lambda@75:17⸨e=[b0, b0]⸩))⟩, mMemo_1@xxxx, null);
 176: addRef(X9); addRef(X3); X12 ← newStackEntry(⟦LoopCore.Iterate.nextState ∥ loop=SaveUnordered, it=TransformedIterator(ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, I15), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[I10, I13]⸩, Filter(lambda@73:24⸨h=I1, w=I2, visited=ReshapedArray([I1, I2], X9), m=ReshapedArray([I1, I2], X3)⸩)), lambda@75:17⸨e=[I10, I13]⸩))⟧);
 177: X10 ← TState.fillStackEntry(X0, X14, X12, ⟨x0:*[]@xxxx⟩, mMemo_h41@xxxx, null);
=178: X10 ← TState.fillStackEntry(X0, X10, ⟦LoopCore.enumerateDefault⟧, ⟨x0:*[]@xxxx⟩, mMemo_h38@xxxx, null);
 179: X10 ← TState.fillStackEntry(X0, X10, ⟦LoopCore.EmitAll.enumerate⟧, ⟨LoopRW(Absent, x0:*[]@xxxx)⟩, mMemo_h38@xxxx, null);
 180: X10 ← TState.fillStackEntry(X0, X10, ⟦bfs.r8t+0:71_27 nextHops_rw = emitAll(nextHops_ro, nextHops_rw, _t0) ∥ nextHops_ro=LoopRO(EnumerateValues, SaveUnordered, True), _key=Absent⟧, ⟨⸨LoopExit(loop@58_break@66⸨path=x0:*[]@xxxx⸩); loop@58_state⸨nextHops_rw=LoopRW(Absent, x0:*[]@xxxx)⸩⸩, loop@58⸨nextHops_ro=LoopRO(EnumerateValues, SaveUnordered, True), _eKind=EnumerateValues, end=[b0, b0], visited=ReshapedArray([b0, b0], x0:*[]@xxxx), start=[b0, b0], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=b0, w=b0, m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩, ArrayIterator(x0:*[]@xxxx, EnumerateValues, b0)⟩, mMemo_h86@xxxx, null);
=181: addRef(X9); addRef(X3); X12 ← newStackEntry(⟦LoopCore.Iterate.nextState ∥ loop=loop@58⸨nextHops_ro=LoopRO(EnumerateValues, SaveUnordered, True), _eKind=EnumerateValues, end=[I6, I7], visited=ReshapedArray([I1, I2], X9), start=[I4, I5], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=I1, w=I2, m=ReshapedArray([I1, I2], X3)⸩, it=ArrayIterator(X8, EnumerateValues, I11)⟧);
 182: X10 ← TState.fillStackEntry(X0, X10, X12, ⟨⸨LoopExit(loop@58_break@66⸨path=x0:*[]@xxxx⸩); loop@58_state⸨nextHops_rw=LoopRW(Absent, x0:*[]@xxxx)⸩⸩⟩, mMemo_h40@xxxx, null);
 183: X8 ← TState.fillStackEntry(X0, X10, ⟦LoopCore.enumerateDefault⟧, ⟨⸨LoopExit(loop@58_break@66⸨path=x0:*[]@xxxx⸩); loop@58_state⸨nextHops_rw=LoopRW(Absent, x0:*[]@xxxx)⸩⸩⟩, mMemo_h38@xxxx, null);
 184: X10 ← newStackEntry(⟦bfs.r8t+0:58_10 _t0 = enumerate(frontier, _t1, loop@58⸨nextHops_ro=nextHops_ro, _eKind=_t1, end=end, visited=visited, start=start, ds=ds, h=h, w=w, m=m⸩, loop@58_state⸨nextHops_rw=_t0⸩) ∥ visited=ReshapedArray([I1, I2], X9), nextHops_ro=LoopRO(EnumerateValues, SaveUnordered, True)⟧);
 185: X8 ← TState.fillStackEntry(X0, X8, X10, ⟨⸨LoopExit(loop@55_break@66⸨path=x0:*[]@xxxx⸩); loop@55_state⸨frontier=x0:*[]@xxxx, visited=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩⸩, loop@55⸨end=[b0, b0], start=[b0, b0], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=b0, w=b0, m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩⟩, mMemo_h72@xxxx, null); → 166
-186: addRef(X9); addRef(X3); X14 ← newStackEntry(⟦LoopCore.Iterate.afterNext ∥ element=[[I10, I13], [I18, I19]], it=TransformedIterator(ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, I15), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[I10, I13]⸩, Filter(lambda@73:24⸨h=I1, w=I2, visited=ReshapedArray([I1, I2], X9), m=ReshapedArray([I1, I2], X3)⸩)), lambda@75:17⸨e=[I10, I13]⸩)), loop=SaveUnordered, state=X12⟧);
 187: X10 ← TState.fillStackEntry(X0, null, X14, ⟨x0:*[]@xxxx⟩, mMemo_h41@xxxx, null); → 178
-188: X17 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=2, it=ArrayIterator([I10, I13], EnumerateAllKeys, 2)⟧);
 189: X17 ← TState.fillStackEntry(X0, null, X17, ⟨⸨[[b0], b0]; Absent⸩, ArrayIterator([b0, b0], EnumerateAllKeys, b0), JoinedIterator((empty), [i0, i0], EnumerateAllKeys)⟩, mMemo_1@xxxx, null);
 190: X20 ← newStackEntry(⟦CollectionCore.NextJoinedIterator.next ∥ it=JoinedIterator((empty), [I14, I16], EnumerateAllKeys)⟧);
 191: X14 ← TState.fillStackEntry(X0, X17, X20, ⟨⸨[[b0], [b0, i0]]; Absent⸩, JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), TransformedIterator((empty), EnumerateAllKeys, ⟦`add:2`⟧)⟩, mMemo_4@xxxx, null);
 192: X14 ← TState.fillStackEntry(X0, X14, ⟦CollectionCore.NextTransformedIterator.next ∥ it=TransformedIterator(ToBeSet, EnumerateAllKeys, ⟦`add:2`⟧)⟧, ⟨⸨[[b0], b0]; Absent⸩, TransformedIterator(JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), EnumerateAllKeys, ⟦`add:2`⟧), SaverLoop(SaveElements), [b0, b0]⟩, mMemo_7@xxxx, null);
 193: X16 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=SaverLoop(SaveElements), state=[I18, I19]⟧);
 194: X14 ← TState.fillStackEntry(X0, X14, X16, ⟨[b0, b0], SaverLoop(SaveElements)⟩, mMemo_14@xxxx, null);
=195: X14 ← TState.fillStackEntry(X0, X14, ⟦LoopCore.enumerateDefault⟧, ⟨[b0, b0], SaverLoop(SaveElements)⟩, mMemo_15@xxxx, null);
 196: X14 ← TState.fillStackEntry(X0, X14, ⟦LoopCore.PipeCollectionCollector.enumerate ∥ loop=SaverLoop(SaveElements)⟧, ⟨[b0, b0]⟩, mMemo_23@xxxx, null);
 197: X14 ← TState.fillStackEntry(X0, X14, ⟦bfs.r8t+0:72_3 _t0 = pipe(_t0, _t1)⟧, ⟨[b0, b0], Filter(lambda@73:24⸨h=b0, w=b0, visited=ReshapedArray([b0, b0], x0:*[]@xxxx), m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩)⟩, mMemo_31@xxxx, null);
 198: addRef(X9); addRef(X3); X16 ← newStackEntry(⟦CollectionCore.AtTransformed.at ∥ second=Filter(lambda@73:24⸨h=I1, w=I2, visited=ReshapedArray([I1, I2], X9), m=ReshapedArray([I1, I2], X3)⸩)⟧);
 199: X14 ← TState.fillStackEntry(X0, X14, X16, ⟨⸨[b0, b0]; Absent⸩, lambda@75:17⸨e=[b0, b0]⸩⟩, mMemo_h56@xxxx, null);
 200: X16 ← newStackEntry(⟦CollectionCore.AtTransformed.at ∥ second=lambda@75:17⸨e=[I10, I13]⸩⟧);
 201: X14 ← TState.fillStackEntry(X0, X14, X16, ⟨⸨[[b0, b0], [b0, b0]]; Absent⸩, Undef, ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, b0), TransformedIterator((empty), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[b0, b0]⸩, Filter(lambda@73:24⸨h=b0, w=b0, visited=ReshapedArray([b0, b0], x0:*[]@xxxx), m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩)), lambda@75:17⸨e=[b0, b0]⸩))⟩, mMemo_h40@xxxx, null);
 202: addRef(X9); addRef(X3); X16 ← newStackEntry(⟦CollectionCore.NextTransformedIterator.at ∥ key=Undef, innerIt=ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, I15), it=TransformedIterator((empty), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[I10, I13]⸩, Filter(lambda@73:24⸨h=I1, w=I2, visited=ReshapedArray([I1, I2], X9), m=ReshapedArray([I1, I2], X3)⸩)), lambda@75:17⸨e=[I10, I13]⸩))⟧);
 203: X14 ← TState.fillStackEntry(X0, X14, X16, ⟨⸨[[b0, b0], [b0, b0]]; Absent⸩, TransformedIterator(ArrayIterator([[-1, 0], [1, 0], [0, -1], [0, 1]], EnumerateValues, b0), EnumerateValues, TransformedLambda(TransformedLambda(lambda@72:17⸨e=[b0, b0]⸩, Filter(lambda@73:24⸨h=b0, w=b0, visited=ReshapedArray([b0, b0], x0:*[]@xxxx), m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩)), lambda@75:17⸨e=[b0, b0]⸩)), SaveUnordered, x0:*[]@xxxx⟩, mMemo_h39@xxxx, null);
 204: X10 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=SaveUnordered, state=X12⟧);
 205: X10 ← TState.fillStackEntry(X0, X14, X10, ⟨x0:*[]@xxxx⟩, mMemo_h41@xxxx, null); → 178
-206: X17 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=1, it=ArrayIterator([I10, I13], EnumerateAllKeys, 1)⟧);
 207: X17 ← TState.fillStackEntry(X0, null, X17, ⟨⸨[[b0], b0]; Absent⸩, ArrayIterator([b0, b0], EnumerateAllKeys, b0), JoinedIterator((empty), [i0, i0], EnumerateAllKeys)⟩, mMemo_1@xxxx, null);
 208: X19 ← newStackEntry(⟦CollectionCore.NextJoinedIterator.next ∥ it=JoinedIterator((empty), [I14, I16], EnumerateAllKeys)⟧);
 209: X14 ← TState.fillStackEntry(X0, X17, X19, ⟨⸨[[b0], [b0, i0]]; Absent⸩, JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), TransformedIterator((empty), EnumerateAllKeys, ⟦`add:2`⟧)⟩, mMemo_4@xxxx, null);
 210: X14 ← TState.fillStackEntry(X0, X14, ⟦CollectionCore.NextTransformedIterator.next ∥ it=TransformedIterator(ToBeSet, EnumerateAllKeys, ⟦`add:2`⟧)⟧, ⟨⸨[[b0], b0]; Absent⸩, TransformedIterator(JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), EnumerateAllKeys, ⟦`add:2`⟧), SaverLoop(SaveElements), [b0, b0]⟩, mMemo_7@xxxx, null);
 211: X16 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=SaverLoop(SaveElements), state=[I18, 0]⟧);
 212: X14 ← TState.fillStackEntry(X0, X14, X16, ⟨[b0, b0], SaverLoop(SaveElements)⟩, mMemo_14@xxxx, null); → 195
-213: X17 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=0, it=ArrayIterator([I10, I13], EnumerateAllKeys, 0)⟧);
 214: X17 ← TState.fillStackEntry(X0, null, X17, ⟨⸨[[b0], b0]; Absent⸩, ArrayIterator([b0, b0], EnumerateAllKeys, b0), JoinedIterator((empty), [i0, i0], EnumerateAllKeys)⟩, mMemo_1@xxxx, null);
 215: X18 ← newStackEntry(⟦CollectionCore.NextJoinedIterator.next ∥ it=JoinedIterator((empty), [I14, I16], EnumerateAllKeys)⟧);
 216: X14 ← TState.fillStackEntry(X0, X17, X18, ⟨⸨[[b0], [b0, i0]]; Absent⸩, JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), TransformedIterator((empty), EnumerateAllKeys, ⟦`add:2`⟧)⟩, mMemo_4@xxxx, null);
 217: X14 ← TState.fillStackEntry(X0, X14, ⟦CollectionCore.NextTransformedIterator.next ∥ it=TransformedIterator(ToBeSet, EnumerateAllKeys, ⟦`add:2`⟧)⟧, ⟨⸨[[b0], b0]; Absent⸩, TransformedIterator(JoinedIterator(ArrayIterator([b0, b0], EnumerateAllKeys, b0), [i0, i0], EnumerateAllKeys), EnumerateAllKeys, ⟦`add:2`⟧), SaverLoop(SaveElements), [b0, b0]⟩, mMemo_7@xxxx, null);
 218: X14 ← TState.fillStackEntry(X0, X14, ⟦LoopCore.Iterate.next ∥ loop=SaverLoop(SaveElements), state=[ToBeSet, ToBeSet]⟧, ⟨[b0, b0], SaverLoop(SaveElements)⟩, mMemo_14@xxxx, null); → 195
-219: X10 ← newStackEntry(⟦ArrayCore.NextArrayIterator.startLoop ∥ index=0, it=ArrayIterator([[I15, I16]], EnumerateAllKeys, 0)⟧);
 220: X14 ← TState.fillStackEntry(X0, null, X10, ⟨⸨[[1], [b0, b0]]; Absent⸩, ArrayIterator([[b0, b0]], EnumerateAllKeys, 1), SaverLoop(SaveWithOffset(0)), x0:*[]@xxxx⟩, mMemo_1@xxxx, null);
 221: X10 ← newStackEntry(⟦LoopCore.Iterate.next ∥ loop=SaverLoop(SaveWithOffset(0)), state=X12⟧);
 222: X14 ← TState.fillStackEntry(X0, X14, X10, ⟨x0:*[]@xxxx⟩, mMemo_5@xxxx, null);
 223: X14 ← TState.fillStackEntry(X0, X14, ⟦LoopCore.enumerateDefault⟧, ⟨x0:*[]@xxxx⟩, mMemo_6@xxxx, null);
 224: X10 ← TState.fillStackEntry(X0, X14, ⟦ArrayCore.ReplaceElement.afterSizes⟧, ⟨x0:*[]@xxxx⟩, mMemo_8@xxxx, null);
 225: X12 ← newStackEntry(⟦bfs.r8t+0:64_4 path = replaceElement(path, [_t0], [e]) ∥ e=[I15, I16], start=[I4, I5]⟧);
 226: X10 ← TState.fillStackEntry(X0, X10, X12, ⟨⸨LoopExit(loop@62_break@66⸨path=x0:*[]@xxxx⸩); loop@62_state⸨path=x0:*[]@xxxx, e=[b0, b0]⸩⸩, loop@62⸨visited=ReshapedArray([b0, b0], x0:*[]@xxxx), start=[b0, b0]⸩⟩, mMemo_27@xxxx, null);
 227: addRef(X9); X12 ← newStackEntry(⟦LoopCore.IterateUnbounded.at ∥ lambda=loop@62⸨visited=ReshapedArray([I1, I2], X9), start=[I4, I5]⸩⟧);
 228: X10 ← TState.fillStackEntry(X0, X10, X12, ⟨LoopExit(loop@62_break@66⸨path=x0:*[]@xxxx⸩)⟩, mMemo_28@xxxx, null);
=229: X10 ← TState.fillStackEntry(X0, X10, ⟦bfs.r8t+0:62_17 _t0 = iterateUnbounded(loop@62⸨visited=visited, start=start⸩, loop@62_state⸨path=path, e=e⸩)⟧, ⟨⸨LoopExit(loop@58_break@66⸨path=x0:*[]@xxxx⸩); loop@58_state⸨nextHops_rw=LoopRW(Absent, x0:*[]@xxxx)⸩⸩, loop@58⸨nextHops_ro=LoopRO(EnumerateValues, SaveUnordered, True), _eKind=EnumerateValues, end=[b0, b0], visited=ReshapedArray([b0, b0], x0:*[]@xxxx), start=[b0, b0], ds=[[-1, 0], [1, 0], [0, -1], [0, 1]], h=b0, w=b0, m=ReshapedArray([b0, b0], x0:*[]@xxxx)⸩, ArrayIterator(x0:*[]@xxxx, EnumerateValues, b0)⟩, mMemo_h86@xxxx, null); → 181
-230: addRef(X9); X14 ← newStackEntry(⟦LoopCore.IterateUnbounded.afterAt ∥ state=loop@62_state⸨path=X12, e=[I10, I13]⸩, lambda=loop@62⸨visited=ReshapedArray([I1, I2], X9), start=[I4, I5]⸩⟧);
 231: X10 ← TState.fillStackEntry(X0, null, X14, ⟨LoopExit(loop@62_break@66⸨path=x0:*[]@xxxx⸩)⟩, mMemo_28@xxxx, null); → 229
-232: dropRef{X9};
-233: X8 ← newStackEntry(⟦bfs.r8t+0:49_0 _t0 = sizes(m) ∥ m=ReshapedArray([I1, I2], X3), start=[I4, I5], end=[I6, I7]⟧);
 234: X1 ← TState.fillStackEntry(X0, null, X8, ⟨x0:*[]@xxxx⟩, mMemo_x@xxxx, null); → 65
---
allocated=21024/711, peak=6208
 */
